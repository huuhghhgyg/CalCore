本程序集提供一些简单的数据处理方法，主要是对矩阵类型的数据进行处理。
此文档中的函数都在`CalCore.Data`的`namespace`中，使用前需要添加引用
```c#
using CalCore.Data;
```

# 指标标准化

> Tips💡：当函数参数类型为`Matrix`时，由于`Marix`是类，输入函数的是映射的对象。因此，函数可以直接对映射进行操作从而直接对原矩阵进行修改，不需要返回值。

## 矩阵指标正向化
本程序集支持将矩阵列指标正向化。常见的指标类型共有4种：
| 指标名称   | 指标特点         | 例子                     |
| ---------- | ---------------- | ------------------------ |
| 极大型指标 | 越大越好         | 成绩、利润               |
| 极小型指标 | 越小越好         | 费用、污染程度           |
| 中间型指标 | 越接近某个值越好 | 水质评估的pH值           |
| 区间型指标 | 落在某个区间最好 | 体温、水中植物营养物含量 |

对于以上各类指标，常见的处理方式为将所有指标转化为极大型指标，称为指标正向化。正向化后方便对数据进行处理。

本程序集中将其他3类指标转化为极大型指标的函数如下
| 函数                             | 含义                         |
| -------------------------------- | ---------------------------- |
| `Normalize.NormalizeFromMin()`   | 将极小型指标转化为极大型指标 |
| `Normalize.NormalizeFromVal()`   | 将中间型转化为极大型指标     |
| `Normalize.NormalizeFromRange()` | 将区间型转化为极大型指标     |

### 从极小型指标转化
```c#
void NormalizeFromMin(Matrix matrix, int col);
void NormalizeFromMin(Matrix matrix, int[] cols);
```
| 参数     | 含义                                         |
| -------- | -------------------------------------------- |
| `matrix` | 指标矩阵                                     |
| `col`    | 需要从极小型指标转化的某列                   |
| `cols`   | 列数组，这些列将从极小型指标转化为极大型指标 |

### 从中间型指标转化
```c#
void NormalizeFromVal(Matrix matrix, double val, int col)
```
| 参数     | 含义                             |
| -------- | -------------------------------- |
| `matrix` | 指标矩阵                         |
| `val`    | 中间值，越靠近中间值的值分数越高 |
| `col`    | 需要从极小型指标转化的某列       |

### 从区间型指标转化
```c#
void NormalizeFromRange(Matrix matrix, double lb, double ub, int col);
```
| 参数     | 含义                       |
| -------- | -------------------------- |
| `matrix` | 指标矩阵                   |
| `lb`     | 区间下界                   |
| `ub`     | 区间上界                   |
| `col`    | 需要从极小型指标转化的某列 |
[lb,ub]表示理想区间，落在区间内的值得分最高，离区间范围越远的值得分越低。

## 标准化矩阵
标准化后矩阵中的值都将落在[0,1]的区间内，同时消去各指标量纲(计量单位不同对于得分大小)的影响。
由于这种标准化方法使用了平方求和再开方的方法，因此不适用于处理含有负数的数据。
```c#
void Normalize.Standardize(Matrix matrix);
```
`matrix`为需要标准化并消除量纲影响的矩阵。默认其中行数为样本数，列数为指标数。

以下方法适用于处理含有负数的数据，将其映射到[0,1]区间
```c#
void StandardizeNegative(Matrix matrix);
```
`matrix`含义同上。

# 数据评价
程序集中目前支持计算优劣解距离法(TOPSIS)的得分。

## TOPSIS评分
输入进行过指标正向化和标准化的矩阵，将返回一个`double[]`类型的数组，表示每个样本的得分。
```c#
double[] Evaluation.TOPSIS_Score(Matrix matrix, [double[] weight])
```
| 参数     | 含义                                         |
| -------- | -------------------------------------------- |
| `matrix` | 指标矩阵。每行表示一个样本，每列表示一个指标 |
| `weight` | 权重数组，要求其长度和指标矩阵的列数相同     |


# 完整示例
此部分示例包括[矩阵指标正向化](#矩阵指标正向化)和[标准化矩阵](#标准化矩阵)两部分内容。
```c#
// 创建矩阵
Matrix mt1 = new Matrix(
    "[4.69000000000000,6.59000000000000,51,11.9400000000000;2.03000000000000,7.86000000000000,19,6.46000000000000;9.11000000000000,6.31000000000000,46,8.91000000000000;8.61000000000000,7.05000000000000,46,26.4300000000000;7.13000000000000,6.50000000000000,50,23.5700000000000;2.39000000000000,6.77000000000000,38,24.6200000000000;7.69000000000000,6.79000000000000,38,6.01000000000000;9.30000000000000,6.81000000000000,27,31.5700000000000;5.45000000000000,7.62000000000000,5,18.4600000000000;6.19000000000000,7.27000000000000,17,7.51000000000000;7.93000000000000,7.53000000000000,9,6.52000000000000;4.40000000000000,7.28000000000000,17,25.3000000000000;7.46000000000000,8.24000000000000,23,14.4200000000000;2.01000000000000,5.55000000000000,47,26.3100000000000;2.04000000000000,6.40000000000000,23,17.9100000000000;7.73000000000000,6.14000000000000,52,15.7200000000000;6.35000000000000,7.58000000000000,25,29.4600000000000;8.29000000000000,8.41000000000000,39,12.0200000000000;3.54000000000000,7.27000000000000,54,3.16000000000000;7.44000000000000,6.26000000000000,8,28.4100000000000]");
Console.WriteLine(mt1.ValueString); //证明矩阵创建成功(20×4)

// 指标正向化
Normalize.NormalizeFromVal(mt1, 7, 2); //第2列从中间型指标转化，中间值为7
Normalize.NormalizeFromMin(mt1, 3); //第3列从极小型指标转化
Normalize.NormalizeFromRange(mt1, 10, 20, 4); //第4列从区间型指标转化，区间为[10,20]

// 标准化矩阵，消除量纲影响
Normalize.Standardize(mt1);

// 输出矩阵
Console.WriteLine(mt1.ValueString);

// 输出归一化后的得分
double[] scores = Evaluation.TOPSIS_Score(mt1);
Console.WriteLine(new Matrix(scores).ValueString);
```